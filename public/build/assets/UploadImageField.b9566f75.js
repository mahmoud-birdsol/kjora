import"./base.1b1bd1ad.js";import{v as P}from"./loading.0484db5f.js";import{r,T as j,h as D,y as R,o as _,c as L,w as b,a as t,b as i,f as I,t as k,q as U,u as m,d as C,I as y,v as T}from"./app.8ff0f107.js";import{_ as W}from"./Modal.b3ff11aa.js";import{_ as z}from"./PrimaryButton.11a51cad.js";import{_ as A}from"./InputError.f29c6013.js";import{C as E}from"./Crop.ae2eb42b.js";import{_ as O}from"./Title.f9acf21c.js";import{r as G}from"./PlusCircleIcon.76342808.js";import{r as H}from"./XMarkIcon.4621726c.js";const J={class:"flex flex-col min-h-[500px] justify-between p-6 pt-0"},K={class:"flex items-center justify-center py-8 sm:px-20"},Q={class:"max-w-[300px] w-full"},X={class:"flex items-center justify-center mb-6"},Y=["src"],Z={class:"absolute inset-0 w-full h-full bg-transparent hover:bg-white hover:bg-opacity-50"},ee={class:"flex flex-col items-center justify-center h-full opacity-0 hover:opacity-100"},ce={__name:"UploadImageField",props:{modelValue:{required:!1,default:null},shouldUpload:{require:!1,type:Boolean,default:!1},currentImageUrl:{required:!1,type:String,default:null},modelName:{required:!1,type:String},modelId:{required:!1,type:Number},collectionName:{required:!1,type:String},show:{type:Boolean,default:!1},maxWidth:{type:String,default:"2xl"},closeable:{type:Boolean,default:!0},position:{required:!1,type:String,default:"center"}},emits:["close","update:modelValue","selected"],setup(u,{emit:M}){const l=u,v=M,d=r(!1),a=r(null),c=r(null),o=r(null),h=r(!1),f=j({model_name:l.modelName,model_id:l.modelId,collection_name:l.collectionName,image:null}),x=r(Math.floor(Math.random()*100)),p=r({}),n=r(!1);D(()=>{l.currentImageUrl&&(d.value=!0,a.value=l.currentImageUrl)}),R(()=>l.currentImageUrl,()=>{l.currentImageUrl&&(d.value=!0,a.value=l.currentImageUrl)});const N=()=>{c.value.value="",c.value.click()},S=()=>{if(!c.value.files.length)return;o.value=c.value.files[0],h.value=!0;const e=new FileReader;e.onload=s=>{a.value=s.target.result,d.value=!0},e.readAsDataURL(o.value),e.onloadend=()=>{V(a)}},q=()=>{d.value=!1,a.value=null,p.value={},n.value=!1},B=()=>{if(!l.shouldUpload){v("update:modelValue",o.value),v("selected",a.value),g();return}o.value&&(f.image=o.value),f.post(route("upload"),{preserveState:!0,preserveScroll:!0,onFinish:e=>{g()}})};function $(e,s,w){o.value=e,a.value=s,p.value={}}let V=e=>{p.value={name:o.value.name,url:e},n.value=!0,h.value=!1};function g(){o.value=null,x.value+=1,v("close")}return(e,s)=>{const w=P;return _(),L(W,{show:u.show,"max-width":u.maxWidth,closeable:u.closeable,position:u.position,onClose:g,key:x.value},{default:b(()=>[t("div",J,[i(O,null,{default:b(()=>[I(k(e.$t("upload")),1)]),_:1}),U((_(),C("div",K,[t("div",Q,[t("input",{ref_key:"photoInput",ref:c,type:"file",class:"hidden",onInput:S},null,544),t("div",X,[t("button",{type:"button",class:"inline-flex items-center p-4 text-white bg-black border border-transparent rounded-full shadow-sm hover:bg-black focus:outline-none focus:ring-2 focus:ring-black focus:ring-offset-2",onClick:y(N,["prevent"])},[i(m(G),{class:"w-5 h-5"})])]),U((_(),C("button",{onClick:y(q,["prevent"]),class:"relative w-full rounded"},[t("img",{src:a.value,alt:"",class:"w-full h-auto rounded-lg",id:"img"},null,8,Y),t("div",Z,[t("div",ee,[i(m(H),{class:"w-8 h-8 text-white"})])])])),[[T,d.value&&!n.value],[w,h.value]])])])),[[w,m(f).processing]]),t("div",null,[i(E,{img:p.value,onCrop:$,open:n.value,"onUpdate:open":[s[0]||(s[0]=F=>n.value=F),s[1]||(s[1]=()=>n.value=!1)],presetMode:{mode:"round",width:250,height:250},addOption:{viewMode:1,dragMode:"move",aspectRatio:1,cropBoxResizable:!1}},null,8,["img","open"]),i(z,{onClick:y(B,["prevent"]),disabled:m(f).processing},{default:b(()=>[I(k(e.$t("upload")),1)]),_:1},8,["disabled"]),i(A,{class:"mt-2",message:m(f).errors.image},null,8,["message"])])])]),_:1},8,["show","max-width","closeable","position"])}}};export{ce as _};
